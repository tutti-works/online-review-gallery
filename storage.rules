rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // ギャラリー画像: 誰でも読み取り可能（開発環境用）、管理者のみ書き込み可能
    match /galleries/{galleryId}/{allPaths=**} {
      allow read: if true;
      allow write: if request.auth != null
        && firestore.get(/databases/(default)/documents/userRoles/$(request.auth.token.email)).data.role == 'admin';
    }

    // その他のパスは拒否
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
